{% extends "base.html" %}

{% block title %}Vendas{% endblock %}
{% block header %}Vendas{% endblock %}

{% block content %}

<div class="card">

    <!-- TOPO DO CARD -->
    <div class="topo-card">
        <strong>Hist√≥rico de Vendas</strong>

        <a href="{{ url_for('nova_venda') }}" class="btn-primary">
            + Nova Venda
        </a>
    </div>

    <!-- TOTAL VENDIDO -->
    <div class="total-vendas">
        <span>Total vendido:</span>
        <strong>R$ {{ "%.2f"|format(total_vendido) }}</strong>
    </div>

    {% if vendas %}

    <!-- TABELA -->
    <table class="tabela-vendas">
        <thead>
            <tr>
                <th>Foto</th>
                <th>Produto</th>
                <th>Qtd</th>
                <th>Pre√ßo Unit.</th>
                <th>Total</th>
                <th>Data</th>
                <th style="text-align:center;">A√ß√µes</th>
            </tr>
        </thead>

        <tbody>
            {% for v in vendas %}
            <tr>

                <!-- FOTO -->
                <td class="foto-produto">
                    {% if v.produto.imagem %}
                        <a href="{{ url_for('static', filename='uploads/' ~ v.produto.imagem) }}" target="_blank">
                            <img src="{{ url_for('static', filename='uploads/' ~ v.produto.imagem) }}">
                        </a>
                    {% else %}
                        ‚Äî
                    {% endif %}
                </td>

                <td>{{ v.produto.nome }}</td>
                <td>{{ v.quantidade }}</td>
                <td>R$ {{ "%.2f"|format(v.preco_unitario) }}</td>

                <td>
                    <strong>R$ {{ "%.2f"|format(v.quantidade * v.preco_unitario) }}</strong>
                </td>

                <td>{{ v.data.strftime("%d/%m/%Y") }}</td>

                <!-- A√á√ïES -->
                <td class="acoes">
                    <a href="{{ url_for('editar_venda', venda_id=v.id) }}" class="acao editar">
                        ‚úè
                    </a>

                    <a href="{{ url_for('excluir_venda', venda_id=v.id) }}"
                       class="acao excluir"
                       onclick="return confirm('Deseja excluir esta venda?')">
                        üóë
                    </a>
                </td>

            </tr>
            {% endfor %}
        </tbody>

    </table>

    {% else %}
        <p style="margin-top:10px;">Nenhuma venda registrada.</p>
    {% endif %}

</div>

{% endblock %}
